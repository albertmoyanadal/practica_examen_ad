<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Albert Moya">

<title>La Influència del Teletreball en la Salut Mental</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="albert_moya_taller_files/libs/clipboard/clipboard.min.js"></script>
<script src="albert_moya_taller_files/libs/quarto-html/quarto.js"></script>
<script src="albert_moya_taller_files/libs/quarto-html/popper.min.js"></script>
<script src="albert_moya_taller_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="albert_moya_taller_files/libs/quarto-html/anchor.min.js"></script>
<link href="albert_moya_taller_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="albert_moya_taller_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="albert_moya_taller_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="albert_moya_taller_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="albert_moya_taller_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introducció" id="toc-introducció" class="nav-link active" data-scroll-target="#introducció">Introducció</a></li>
  <li><a href="#dades" id="toc-dades" class="nav-link" data-scroll-target="#dades">Dades</a>
  <ul class="collapse">
  <li><a href="#dades-simulades" id="toc-dades-simulades" class="nav-link" data-scroll-target="#dades-simulades">Dades Simulades</a></li>
  <li><a href="#dades-extra" id="toc-dades-extra" class="nav-link" data-scroll-target="#dades-extra">Dades Extra</a></li>
  </ul></li>
  <li><a href="#anàlisi-descriptiu" id="toc-anàlisi-descriptiu" class="nav-link" data-scroll-target="#anàlisi-descriptiu">Anàlisi descriptiu</a>
  <ul class="collapse">
  <li><a href="#interpretació-de-la-variància-total-i-generalitzada" id="toc-interpretació-de-la-variància-total-i-generalitzada" class="nav-link" data-scroll-target="#interpretació-de-la-variància-total-i-generalitzada">Interpretació de la variància total i generalitzada</a></li>
  </ul></li>
  <li><a href="#modelització-del-nivell-destrès-amb-una-distribució-multinomial-revisió" id="toc-modelització-del-nivell-destrès-amb-una-distribució-multinomial-revisió" class="nav-link" data-scroll-target="#modelització-del-nivell-destrès-amb-una-distribució-multinomial-revisió">Modelització del nivell d’estrès amb una distribució multinomial (revisió)</a>
  <ul class="collapse">
  <li><a href="#estimació-dels-paràmetres" id="toc-estimació-dels-paràmetres" class="nav-link" data-scroll-target="#estimació-dels-paràmetres">Estimació dels paràmetres</a></li>
  <li><a href="#probabilitat-dun-esdeveniment-en-una-mostra-de-20" id="toc-probabilitat-dun-esdeveniment-en-una-mostra-de-20" class="nav-link" data-scroll-target="#probabilitat-dun-esdeveniment-en-una-mostra-de-20">Probabilitat d’un Esdeveniment en una Mostra de 20</a></li>
  </ul></li>
  <li><a href="#regressió-multivariant" id="toc-regressió-multivariant" class="nav-link" data-scroll-target="#regressió-multivariant">Regressió multivariant</a></li>
  <li><a href="#contrast-dhipòtesis" id="toc-contrast-dhipòtesis" class="nav-link" data-scroll-target="#contrast-dhipòtesis">Contrast d’Hipòtesis</a>
  <ul class="collapse">
  <li><a href="#contrast-teòric" id="toc-contrast-teòric" class="nav-link" data-scroll-target="#contrast-teòric">Contrast teòric</a></li>
  <li><a href="#implementació-amb-la-funció-hotelling.test" id="toc-implementació-amb-la-funció-hotelling.test" class="nav-link" data-scroll-target="#implementació-amb-la-funció-hotelling.test">Implementació amb la funció <code>hotelling.test</code></a></li>
  <li><a href="#interpretació-dels-resultats" id="toc-interpretació-dels-resultats" class="nav-link" data-scroll-target="#interpretació-dels-resultats">Interpretació dels resultats</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">La Influència del Teletreball en la Salut Mental</h1>
<p class="subtitle lead">Taller avaluable - Anàlisis de Dades</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Albert Moya </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introducció" class="level2">
<h2 class="anchored" data-anchor-id="introducció">Introducció</h2>
<p>El <strong>teletreball</strong> ha esdevingut una pràctica molt popular en els darrers anys, impulsada especialment per la crisi sanitària derivada de la <em>COVID-19</em>. Durant el període de confinament, una de les poques opcions per mantenir l’activitat laboral va ser treballar des de casa, fet que va portar moltes empreses a implantar aquesta modalitat com a mesura de seguretat per als treballadors, assegurant així la continuïtat del negoci.</p>
<p>Ara que hem retornat a la normalitat, el teletreball es manté en diversos sectors, no tant per motius de seguretat sinó per la seva <em>comoditat i flexibilitat</em>. Tanmateix, sorgeix una pregunta fonamental: <strong>Quin impacte té el teletreball en la salut mental dels treballadors? És realment positiu o presenta desavantatges ocults?</strong></p>
<p>Aquest estudi té com a objectiu principal explorar la relació entre el teletreball i els indicadors de salut mental, com ara l’estrès i la qualitat del son, així com comprendre si aquest impacte és similar en aquells que treballen de manera presencial o híbrida.</p>
</section>
<section id="dades" class="level2">
<h2 class="anchored" data-anchor-id="dades">Dades</h2>
<section id="dades-simulades" class="level3">
<h3 class="anchored" data-anchor-id="dades-simulades">Dades Simulades</h3>
<p>En aquest apartat, simulem una base de dades amb l’objectiu d’examinar la relació entre el <strong>teletreball</strong> i la <strong>salut mental</strong>. El conjunt de dades generat inclou <strong>100 observacions</strong> i 12 variables dividides en tres categories: <strong>quantitatives</strong>, <strong>ordinals</strong> i <strong>nominals</strong>. Aquestes variables han estat escollides per cobrir diferents aspectes del perfil laboral i la salut dels participants, la qual cosa ens permetrà analitzar amb més precisió la hipòtesi plantejada.</p>
<p>Les variables proposades són les següents:</p>
<ul>
<li><strong>Variables Nominals</strong>:
<ul>
<li><strong>Gènere</strong>: Identitat de gènere del treballador/a.</li>
<li><strong>Feina</strong>: Tipus de feina del treballador/a.</li>
<li><strong>Localització</strong>: Modalitat de treball (teletreball, oficina, o híbrid).</li>
</ul></li>
<li><strong>Variables Quantitatives</strong>:
<ul>
<li><strong>Edat</strong>: Edat en anys.</li>
<li><strong>Anys d’experiència</strong>: Nombre d’anys d’experiència laboral.</li>
<li><strong>Salari</strong>: Salari anual en euros.</li>
<li><strong>Nombre d’hores de feina setmanals</strong>: Hores setmanals dedicades a la feina.</li>
<li><strong>Nombre de <em>meetings</em> setmanals</strong>: Nombre de reunions virtuals per setmana.</li>
</ul></li>
<li><strong>Variables Ordinals</strong>:
<ul>
<li><strong>Activitat física</strong>: Freqüència amb la qual el treballador/a realitza activitat física (cap, setmanal, diària).</li>
<li><strong>Qualitat de son</strong>: Qualitat percebuda del son (bona, normal, dolenta).</li>
<li><strong>Nivell d’estrès</strong>: Nivell d’estrès percebut (baix, mitjà, alt).</li>
<li><strong>Satisfacció amb el teletreball</strong>: Grau de satisfacció amb el teletreball (insatisfet, neutre, satisfet).</li>
</ul></li>
</ul>
<p>A continuació, es presenta una mostra de les deu primeres observacions de les dades simulades:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Base de dades</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Genere</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Feina</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Localitzacio</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Edat</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Anys_experiencia</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Salari</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Hores_feina_setmanals</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Meetings_setmanals</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Activitat_fisica</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Qualitat_son</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Nivell_estres</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Satisfaccio_teletreball</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Home</td>
<td style="text-align: center;">Suport</td>
<td style="text-align: center;">Oficina</td>
<td style="text-align: center;">46</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">46934</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">Diariament</td>
<td style="text-align: center;">Bona</td>
<td style="text-align: center;">Alt</td>
<td style="text-align: center;">Neutre</td>
</tr>
<tr class="even">
<td style="text-align: center;">Home</td>
<td style="text-align: center;">Suport</td>
<td style="text-align: center;">Teletreball</td>
<td style="text-align: center;">51</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">51263</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">Setmanalment</td>
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Satisfet</td>
</tr>
<tr class="odd">
<td style="text-align: center;">No-Binari</td>
<td style="text-align: center;">Suport</td>
<td style="text-align: center;">Teletreball</td>
<td style="text-align: center;">28</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">49188</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">Diariament</td>
<td style="text-align: center;">Dolenta</td>
<td style="text-align: center;">Baix</td>
<td style="text-align: center;">Satisfet</td>
</tr>
<tr class="even">
<td style="text-align: center;">Dona</td>
<td style="text-align: center;">Manager</td>
<td style="text-align: center;">Oficina</td>
<td style="text-align: center;">51</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">48585</td>
<td style="text-align: center;">48</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">Setmanalment</td>
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Baix</td>
<td style="text-align: center;">Insatisfet</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Dona</td>
<td style="text-align: center;">Suport</td>
<td style="text-align: center;">Teletreball</td>
<td style="text-align: center;">34</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">49096</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">Diariament</td>
<td style="text-align: center;">Dolenta</td>
<td style="text-align: center;">Alt</td>
<td style="text-align: center;">Satisfet</td>
</tr>
<tr class="even">
<td style="text-align: center;">Dona</td>
<td style="text-align: center;">Desenvolupador</td>
<td style="text-align: center;">Hibrid</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">50237</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">Diariament</td>
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Neutre</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="dades-extra" class="level3">
<h3 class="anchored" data-anchor-id="dades-extra">Dades Extra</h3>
<p>En aquest apartat, enriquiré les dades prèvies obtingudes amb informació addicional de fonts externes. He trobat una base de dades a la pàgina <a href="https://www.kaggle.com/">Kaggle</a> anomenada <a href="https://www.kaggle.com/datasets/waqi786/remote-work-and-mental-health/data">Remote Work &amp; Mental Health</a> que complementarà el nostre anàlisi. Aquesta base de dades conté diversos registres rellevants (molts d’ells m’han inspirat per crear les variables anteriors) entre ells una variable ordinal anomenada <code>productivity_change</code>. Aquesta variable ens indica si la productivitat del treballador ha millorat o empitjorat com a resultat del teletreball.</p>
<p>Per integrar aquesta informació al nostre conjunt de dades, prendrem una mostra aleatòria de 100 observacions de la variable <code>productivity_change</code> i l’afegirem a la nostra base de dades.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Base de dades</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Genere</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Feina</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Localitzacio</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Edat</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Anys_experiencia</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Salari</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Hores_feina_setmanals</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Meetings_setmanals</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Activitat_fisica</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Qualitat_son</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Nivell_estres</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Satisfaccio_teletreball</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Canvi_productivitat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Home</td>
<td style="text-align: center;">Suport</td>
<td style="text-align: center;">Oficina</td>
<td style="text-align: center;">46</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">46934</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">Diariament</td>
<td style="text-align: center;">Bona</td>
<td style="text-align: center;">Alt</td>
<td style="text-align: center;">Neutre</td>
<td style="text-align: center;">Increase</td>
</tr>
<tr class="even">
<td style="text-align: center;">Home</td>
<td style="text-align: center;">Suport</td>
<td style="text-align: center;">Teletreball</td>
<td style="text-align: center;">51</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">51263</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">Setmanalment</td>
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Satisfet</td>
<td style="text-align: center;">Decrease</td>
</tr>
<tr class="odd">
<td style="text-align: center;">No-Binari</td>
<td style="text-align: center;">Suport</td>
<td style="text-align: center;">Teletreball</td>
<td style="text-align: center;">28</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">49188</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">Diariament</td>
<td style="text-align: center;">Dolenta</td>
<td style="text-align: center;">Baix</td>
<td style="text-align: center;">Satisfet</td>
<td style="text-align: center;">Decrease</td>
</tr>
<tr class="even">
<td style="text-align: center;">Dona</td>
<td style="text-align: center;">Manager</td>
<td style="text-align: center;">Oficina</td>
<td style="text-align: center;">51</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">48585</td>
<td style="text-align: center;">48</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">Setmanalment</td>
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Baix</td>
<td style="text-align: center;">Insatisfet</td>
<td style="text-align: center;">Increase</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Dona</td>
<td style="text-align: center;">Suport</td>
<td style="text-align: center;">Teletreball</td>
<td style="text-align: center;">34</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">49096</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">Diariament</td>
<td style="text-align: center;">Dolenta</td>
<td style="text-align: center;">Alt</td>
<td style="text-align: center;">Satisfet</td>
<td style="text-align: center;">Decrease</td>
</tr>
<tr class="even">
<td style="text-align: center;">Dona</td>
<td style="text-align: center;">Desenvolupador</td>
<td style="text-align: center;">Hibrid</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">50237</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">Diariament</td>
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Normal</td>
<td style="text-align: center;">Neutre</td>
<td style="text-align: center;">No Change</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
</section>
<section id="anàlisi-descriptiu" class="level2">
<h2 class="anchored" data-anchor-id="anàlisi-descriptiu">Anàlisi descriptiu</h2>
<p>En aquesta secció farem un anàlisi descriptiu de les dades d’acord amb els objectius que hem anomenat abans. Aquests eren veure la relació entre el teletreball i la salut mental, com ara l’estrés i la quaitat del sonaixí com comprendre si aquest impacte és similar en aquells que treballen de manera presencial o híbrida.</p>
<p><strong>Distribució del nivell d’estrés per localització</strong></p>
<p>Comprovem si la localització del lloc on es fa feina influeix en el nivell d’estrès dels treballadors.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="albert_moya_taller_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Relació entre el salari i les hores de feina setmanals</strong></p>
<p>És interessant veure si les hores de feina i el salari van lligades, pareix coherent exigir un salari major per més hores de feina. També ho podem relacionar amb el nivell d’estrés per veure si fer més hores provoca un major nivell d’estrés.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="albert_moya_taller_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Influència de les hores treballades i la qualitat del son</strong></p>
<p>Ens podem demanar si fer més hores de treball pot influir en la nostra qualitat de son. Moltes vegades, fer feina per damunt les nostres possibilitats dificulta tenir una bona salut de la son.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="albert_moya_taller_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Satisfacció del teletreball per nivell d’estrès</strong></p>
<p>Una altra opció és determinar la percepció que té la gent sobre el teletreball i el seu nivell d’estrès. Sovint les persones no sabem el que ens passa realment, i pot ser esteim molt agust fent teletreball però realment ens està causant estrés.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="albert_moya_taller_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Altres gràfics per fer un anàlisi descriptiu multivariant</strong></p>
<p>Podem fer una gràfica resum de totes les variables que hem tengut en compte per fer les gràfiques anteriors. Ho podem fer usant una matriu de dispersió, que ens és molt útil per trobar la correlació entre dues variables de les nostres dades.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Nivell_estres, Salari, Hores_feina_setmanals, Localitzacio, Qualitat_son, Satisfaccio_teletreball) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpairs</span>(., </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"points"</span>, <span class="at">color =</span> <span class="st">"#F7D6C1"</span>)),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">diag =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"densityDiag"</span>, <span class="at">fill =</span> <span class="st">"#D1A7B8"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="albert_moya_taller_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Amb les variables quantitatives que tenim no té sentit fer una matriu de correlació perquè aparentment pareix que no han de tenir cap tipus de lligadura les dades. Però si que pot ser interessant comparar 3 de les variables ordinals que hem emprat en els gràfics anteriors amb un gràfic de mosaic:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Nivell_estres, Qualitat_son, Activitat_fisica) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">table</span>(a)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(a1,<span class="at">shade=</span><span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="albert_moya_taller_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="interpretació-de-la-variància-total-i-generalitzada" class="level3">
<h3 class="anchored" data-anchor-id="interpretació-de-la-variància-total-i-generalitzada">Interpretació de la variància total i generalitzada</h3>
<p>Per aquest càlcul farem servir la matriu de correlació ja que ens és molt útil per saber si tenim valors alts o baixos (la matriu pren valors entre 0 i 1).</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Variança Total: 5"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Variança Generalitzada: 0.203693625996473"</code></pre>
</div>
</div>
<ul>
<li><p><strong>Variança Total:</strong> Aquesta mesura mostra com varien globalment les dades quantitatives. Com hem obtingut un valor bastant elevat, podem assumir que les dades estan molt disperses respecte a la seva mitjana.</p></li>
<li><p><strong>Variança Generalitzada:</strong> Aquesta mesura mostra com és la dispersió conjunta de les variables. Com hem obtingut un valor baix podem dir que les variables pareixen ser independents.</p></li>
</ul>
</section>
</section>
<section id="modelització-del-nivell-destrès-amb-una-distribució-multinomial-revisió" class="level2">
<h2 class="anchored" data-anchor-id="modelització-del-nivell-destrès-amb-una-distribució-multinomial-revisió">Modelització del nivell d’estrès amb una distribució multinomial (revisió)</h2>
<p>Ara modelitzarem una de les variables ordinals amb una distribució multinomial, per això haurem d’estimar els seus paràmetres. Utilitzarem aquest model per calcular la probabilitat d’un event d’interés en una mostra de mida 20. Seguirem aquests passos amb la variable de <code>Nivell_estres</code> (amb categories: “Baix”, “Mitjà”, “Alt”).</p>
<section id="estimació-dels-paràmetres" class="level3">
<h3 class="anchored" data-anchor-id="estimació-dels-paràmetres">Estimació dels paràmetres</h3>
<p>Primer, calculem les probabilitats per a cada categoria de <code>Nivell_estres</code> a partir de la mostra simulada:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la proporció de cada categoria de la variable Localització</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>prob_estres <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(data<span class="sc">$</span>Nivell_estres))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>prob_estres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  Baix Normal    Alt 
  0.37   0.33   0.30 </code></pre>
</div>
</div>
<p>Aquests valors representen les probabilitats estimades per a cada categoria en la distribució multinomial. Com podem veure són valors bastant equiprobables.</p>
</section>
<section id="probabilitat-dun-esdeveniment-en-una-mostra-de-20" class="level3">
<h3 class="anchored" data-anchor-id="probabilitat-dun-esdeveniment-en-una-mostra-de-20">Probabilitat d’un Esdeveniment en una Mostra de 20</h3>
<p>Suposem que volem calcular la probabilitat de tenir <strong>almenys 8 treballadors amb un nivell d’estrès alt</strong> en una mostra de 20 persones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilitats estimades per a cada categoria</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> prob_estres <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()  </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre total de persones en la mostra i el mínim de persones amb nivell d'estrès alt</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>mida_mostra <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>estres_alt <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilitat de tenir almenys 8 persones amb nivell d'estrès alt</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="dv">7</span>, <span class="at">size =</span> mida_mostra, <span class="at">prob =</span> prob[<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2277282</code></pre>
</div>
</div>
</section>
</section>
<section id="regressió-multivariant" class="level2">
<h2 class="anchored" data-anchor-id="regressió-multivariant">Regressió multivariant</h2>
<p>Volem ajustar un model de regressió multivariant per les nostres dades quantitatives. En el nostre cas, crec que pot ser interessant posar la variable <code>Salari</code> com a variable depenent <span class="math inline">\(Y\)</span>. La resta de variables seran les variables intependents <span class="math inline">\(X_i\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el model de regressió multivariant</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Salari <span class="sc">~</span> Edat <span class="sc">+</span> Anys_experiencia <span class="sc">+</span> Hores_feina_setmanals <span class="sc">+</span> Meetings_setmanals, <span class="at">data =</span> data)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Resum per veure els coeficients estimats i el R^2</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salari ~ Edat + Anys_experiencia + Hores_feina_setmanals + 
    Meetings_setmanals, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4401.3 -1321.3  -114.6  1268.2  4716.4 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           53208.53    2312.53  23.009  &lt; 2e-16 ***
Edat                    158.52      25.47   6.223 1.31e-08 ***
Anys_experiencia         92.76      40.69   2.280  0.02485 *  
Hores_feina_setmanals  -247.16      87.31  -2.831  0.00567 ** 
Meetings_setmanals     -110.40     350.48  -0.315  0.75346    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1916 on 95 degrees of freedom
Multiple R-squared:  0.3506,    Adjusted R-squared:  0.3232 
F-statistic: 12.82 on 4 and 95 DF,  p-value: 2.199e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Càlcul del score</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="cf">function</span>(beta0, beta1, beta2, beta3, beta4) {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1 <span class="sc">*</span> data<span class="sc">$</span>Edat <span class="sc">+</span> beta2 <span class="sc">*</span> data<span class="sc">$</span>Anys_experiencia <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>          beta3 <span class="sc">*</span> data<span class="sc">$</span>Hores_feina_setmanals <span class="sc">+</span> beta4 <span class="sc">*</span> data<span class="sc">$</span>Meetings_setmanals</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span> <span class="fu">sum</span>((data<span class="sc">$</span>Salari <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>)  </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="contrast-dhipòtesis" class="level2">
<h2 class="anchored" data-anchor-id="contrast-dhipòtesis">Contrast d’Hipòtesis</h2>
<p>Per realitzar el contrast d’hipòtesi per dues mitjanes multivariants. En el nostre cas, seguirem l’exemple de l’enunciat i evaluarem si el vector de mitjanes de la variable <code>Salari</code> de l’apartat anterior on li hem dit <span class="math inline">\(Y\)</span> és el mateix per dos nivells distints (alt i baix) de la variable <code>Nivell_estres</code> que hem modelitzat a un apartat anterior.</p>
<p>Volem contrastar si el vector de mitjanes del <strong>salari</strong> és el mateix per als treballadors amb nivell d’estrès baix i per als de nivell d’estrès alt amb un nivell de significació de 0.05. Les hipòtesis són:</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_{baix} = \mu_{alt}\)</span> (el vector de mitjanes és el mateix en ambdós grups)</li>
<li><span class="math inline">\(H_a\)</span>: <span class="math inline">\(\mu_{low} \neq \mu_{high}\)</span> (el vector de mitjanes és diferent entre els dos grups)</li>
</ul>
<section id="contrast-teòric" class="level3">
<h3 class="anchored" data-anchor-id="contrast-teòric">Contrast teòric</h3>
<p>Per a contrastar aquestes hipòtesis de manera teòrica, utilitzem la distribució de Hotelling <span class="math inline">\(T^2\)</span>, que es calcula amb la fórmula:</p>
<p><span class="math display">\[
T^2 = \frac{n_1 n_2}{n_1 + n_2} (\bar{X}_1 - \bar{X}_2)' S_p^{-1} (\bar{X}_1 - \bar{X}_2)
\]</span></p>
<p>on: - <span class="math inline">\(n_1\)</span> i <span class="math inline">\(n_2\)</span> són les mides de mostra dels dos grups (nivells d’estrès baix i alt). - <span class="math inline">\(\bar{X}_1\)</span> i <span class="math inline">\(\bar{X}_2\)</span> són els vectors de mitjanes dels dos grups. - <span class="math inline">\(S_p\)</span> és la matriu de covariància agrupada (estimada a partir de les mostres de cada grup)</p>
<p>Ara feim els càlculs corresponents:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creació de les mostres per als dos grups de nivell d'estrès</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>grup_baix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">subset</span>(data, Nivell_estres <span class="sc">==</span> <span class="st">"Baix"</span>)[, <span class="st">"Salari"</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>grup_alt <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">subset</span>(data, Nivell_estres <span class="sc">==</span> <span class="st">"Alt"</span>)[, <span class="st">"Salari"</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de mostres</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(grup_baix)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(grup_alt)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Mitjanes de cada grup</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>X1_bar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(grup_baix)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>X2_bar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(grup_alt)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrius de covariància de cada grup</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>S1 <span class="ot">&lt;-</span> <span class="fu">cov</span>(grup_baix)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>S2 <span class="ot">&lt;-</span> <span class="fu">cov</span>(grup_alt)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriu de covariància combinada (pooled covariance matrix)</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>Sp <span class="ot">&lt;-</span> (((n1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> S1) <span class="sc">+</span> ((n2 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> S2)) <span class="sc">/</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Càlcul de T^2</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> (n1 <span class="sc">*</span> n2) <span class="sc">/</span> (n1 <span class="sc">+</span> n2) <span class="sc">*</span> <span class="fu">t</span>(X1_bar <span class="sc">-</span> X2_bar) <span class="sc">%*%</span> <span class="fu">solve</span>(Sp) <span class="sc">%*%</span> (X1_bar <span class="sc">-</span> X2_bar)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Graus de llibertat per a la distribució F</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">length</span>(X1_bar)  <span class="co"># Nombre de variables</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> p  <span class="co"># Graus de llibertat del numerador</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> p <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># Graus de llibertat del denominador</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el valor p utilitzant la distribució F</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>p_valor <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(T2 <span class="sc">*</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> p <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (df1 <span class="sc">*</span> (n1 <span class="sc">+</span> n2)), df1, df2)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultat</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>T2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
[1,] 1.533902</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>p_valor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
[1,] 0.226917</code></pre>
</div>
</div>
</section>
<section id="implementació-amb-la-funció-hotelling.test" class="level3">
<h3 class="anchored" data-anchor-id="implementació-amb-la-funció-hotelling.test">Implementació amb la funció <code>hotelling.test</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creació de les mostres per als dos grups de nivell d'estrès</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>grup_baix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">subset</span>(data, Nivell_estres <span class="sc">==</span> <span class="st">"Baix"</span>)[, <span class="st">"Salari"</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>grup_alt <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">subset</span>(data, Nivell_estres <span class="sc">==</span> <span class="st">"Alt"</span>)[, <span class="st">"Salari"</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Contrast de Hotelling</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hotelling.test</span>(grup_baix, grup_alt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpretació-dels-resultats" class="level3">
<h3 class="anchored" data-anchor-id="interpretació-dels-resultats">Interpretació dels resultats</h3>
<p>Com hem vist, fent-ho de manera teòrica i implantant la funció a R ens ha sortit el mateix resultat. Dacord al nivell de significació de 0.05 que hem marcal al començament, no hi ha evidència per rebutjar la hipòtesi nula, per tant concloem en que no existeix una diferència significativa en el <strong>Salari</strong> entre els dos nivell d’estrès. Per tant, podem dir que el nivell d’estrès en els treballadors no garantitza no té un afecte en el seu salari mitjà.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>